#!/usr/bin/env python3
"""
–¢–µ—Å—Ç –ø–∞—Ä—Å–∏–Ω–≥—É –ø–æ—Å—Ç—ñ–≤ –ö—É—á–µ—Ä–∞ (timofii_kucher)
"""

from datetime import datetime

from app import CHANNEL_FUSION, GROQ_ENABLED

print(f'AI (Groq) enabled: {GROQ_ENABLED}')
print()

# –û—á–∏—Å—Ç–∏—Ç–∏
CHANNEL_FUSION.fused_events.clear()
CHANNEL_FUSION.message_to_event.clear()

# –†–µ–∞–ª—å–Ω—ñ –ø–æ—Å—Ç–∏ –ö—É—á–µ—Ä–∞
KUCHER_POSTS = [
    "–ü–∞–≤–ª–æ–≥—Ä–∞–¥ —Ç–µ–∂ —É–≤–∞–∂–Ω–æ üö®",
    "–õ–∏—à–∏–ª–æ—Å—å –¥–æ 5—Ö üö®",
    "–í—Å–µ –∂ —Ç–∞–∫–∏ –Ω–∞ –°–∏–Ω–µ–ª—å–Ω–∏–∫–æ–≤–µ –π–¥—É—Ç—å üö®",
    "–Ø–≤–æ—Ä–Ω–∏—Ü—å–∫–µ - —É–≤–∞–∂–Ω–æ, –º–æ–∂–ª–∏–≤–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤–¥–∞—Ä—è—Ç—å —Ç—É–¥–∏ –∂, –î–°–ù–° —Ç–∞ —Ç—ñ —Ö—Ç–æ –±—ñ–ª—è –ø—Ä–∏–ª—å–æ—Ç—É - –∫—Ä–∞—â–µ —Ç—ñ–∫–∞–π—Ç–µ",
    "–í–∂–µ –∑–∞—Ö–æ–¥—è—Ç—å –≤ –æ–±–ª–∞—Å—Ç—å üö®",
    "–®–≤–∏–¥–∫—ñ—Å—Ç—å —à–∞—Ö–µ–¥–Ω–∞ –≤—ñ–¥ 180 –¥–æ 250 –∫–º/–≥–æ–¥",
    "–°–∏–Ω–µ–ª—å–Ω–∏–∫–æ–≤–µ –∑–∞–≥—Ä–æ–∑–∞ –ë–ø–õ–ê üö®",
    "–ê—Ç–∞–∫—É–≤–∞–ª–∏ –ó–∞–ø–æ—Ä—ñ–∂–∂—è :(",
    "–î–æ 6—Ö –π–¥—É—Ç—å –Ω–∞ —Å—Ö—ñ–¥ –°–∏–Ω–µ–ª—å–Ω–∏–∫–æ–≤–µ –∑ –ø—ñ–≤–Ω–æ—á—ñ, –Ω–∞ —Ü—å–æ–º—É –≤—Å–µ, –æ—Å—Ç–∞–Ω–Ω—ñ, –±—ñ–ª—å—à–µ –Ω–æ–≤–∏—Ö –Ω–µ–º–∞—î üö®",
    "1—Ö –∑ –Ω–∏—Ö –∫—Ä—É–∂–ª—è—î, —è–∫ –≤ –±—ñ–∫ –Ø–≤–æ—Ä–Ω–∏—Ü—å–∫–æ–≥–æ —Ö–æ—á–µ, —ñ–Ω—ñ—à—ñ —è–∫ –≤ –±—ñ–∫ –ó–ü –æ–±–ª–∞—Å—Ç—ñ",
    "–Ø–í–û–†–ù–ò–¶–¨–ö–ï –î–°–ù–° –í–û–ó–î–£–•!!!",
    "–î–æ 2—Ö –ì–æ—Ç–æ–≤–Ω—ñ—Å—Ç—å –¥–æ —É–¥–∞—Ä—É",
    "–î–Ω—ñ–ø—Ä–æ 2 –ë–ø–õ–ê",
    "–£–∫—Ä–∏—Ç—Ç—è",
    "–ù–µ–≥–∞–π–Ω–æ",
    "–ù–∏–∑—å–∫–æ",
    "–ü—Ä–∏–¥–Ω—ñ–∫ / –Ü–≥—Ä–µ–Ω—å",
    "–©–µ 1—Ö –º–æ–∂–µ –±—É—Ç–∏ —á–µ—Ä–µ–∑ –ì—É–±–∏–Ω–∏—Ö—É",
    "1—Ö —á–µ—Ä–µ–∑ –ü–∞–≤–ª–æ–≥—Ä–∞–¥ —Ä-–Ω –≤ –±—ñ–∫ –î–Ω—ñ–ø—Ä–æ–≤—Å—å–∫–æ–≥–æ / –ù–æ–≤—ñ–∫ —Ä-–Ω",
    "2—Ö –ø–æ–∫–∏–¥–∞—î –æ–±–ª–∞—Å—Ç—å",
    "–î–Ω—ñ–ø—Ä–æ 2—Ö –Ω–∞–¥ –º—ñ—Å—Ç–æ–º üö® –ù–∏–∑—å–∫–æ!!",
]

print('=' * 70)
print('–¢–ï–°–¢ –ü–ê–†–°–ò–ù–ì–£ –ü–û–°–¢–Ü–í –ö–£–ß–ï–†–ê (timofii_kucher)')
print('=' * 70)
print()

stats = {'threat': 0, 'region': 0, 'qty': 0, 'direction': 0}

for i, text in enumerate(KUCHER_POSTS, 1):
    msg = {
        'id': f'kucher_{i}',
        'channel': 'timofii_kucher',
        'text': text,
        'date': datetime.now().strftime('%Y-%m-%d %H:%M:%S'),
    }
    sig = CHANNEL_FUSION.extract_message_signature(msg)

    # –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫
    if sig['threat_type']: stats['threat'] += 1
    if sig['regions']: stats['region'] += 1
    if sig['quantity'] > 1: stats['qty'] += 1
    if sig['direction']: stats['direction'] += 1

    print(f'{i:2}. "{text[:60]}{"..." if len(text) > 60 else ""}"')
    print(f'    –¢–∏–ø: {sig["threat_type"] or "‚ùå"}  |  –†–µ–≥—ñ–æ–Ω: {list(sig["regions"]) if sig["regions"] else "‚ùå"}  |  –ö-—Ç—å: {sig["quantity"]}  |  –ù–∞–ø—Ä: {sig["direction"] or "-"}')
    print()

print('=' * 70)
print('–ü–Ü–î–°–£–ú–û–ö:')
print(f'  –¢–∏–ø –∑–∞–≥—Ä–æ–∑–∏: {stats["threat"]}/{len(KUCHER_POSTS)} ({100*stats["threat"]//len(KUCHER_POSTS)}%)')
print(f'  –†–µ–≥—ñ–æ–Ω: {stats["region"]}/{len(KUCHER_POSTS)} ({100*stats["region"]//len(KUCHER_POSTS)}%)')
print(f'  –ö—ñ–ª—å–∫—ñ—Å—Ç—å >1: {stats["qty"]}/{len(KUCHER_POSTS)}')
print(f'  –ù–∞–ø—Ä—è–º–æ–∫: {stats["direction"]}/{len(KUCHER_POSTS)}')
